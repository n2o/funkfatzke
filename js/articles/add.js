// Generated by CoffeeScript 1.8.0
var root;

root = typeof exports !== "undefined" && exports !== null ? exports : this;

$(function() {
  var photoUrl;
  $("#dialog-message").dialog({
    height: 600,
    width: 800,
    autoOpen: false,
    resizable: true,
    modal: true
  });
  $("#button").click(function() {
    var description, is_equipment, name, photo, price, quantity, weight;
    name = $("#name").val();
    description = $("#description").val();
    photo = $("#photo").val();
    weight = $("#weight").val();
    price = $("#price").val();
    price = price.replace(/,/g, ".");
    quantity = $("#quantity").val();
    if ($("#is-equipment").is(":checked")) {
      is_equipment = 1;
    } else {
      is_equipment = 0;
    }
    if (name === "" || description === "") {
      root.growl("Bitte alle erforderlichen Felder ausf端llen.", "info");
    } else {
      $("#button").html("<span class='btn'><span class='glyphicon glyphicon-refresh'></span> Anfrage wird bearbeitet...</span>");
      $.ajax({
        type: "post",
        url: "aux/articles/todb.php",
        data: "name=" + name + "&description=" + description + "&photo=" + photo + "&weight=" + weight + "&price=" + price + "&quantity=" + quantity + "&is_equipment=" + is_equipment,
        success: function() {
          $("form").trigger("reset");
          root.growl("Artikel erfolgreich hinzugef端gt.", "success");
          root.getList();
          return $("#button").html("Artikel hinzuf端gen");
        },
        error: function() {
          return $("#button").html("Artikel hinzuf端gen");
        }
      });
    }
  });
  photoUrl = $("#photo").val();
  if (photoUrl) {
    $("#show-photo img").attr("src", "sites/funk/files/t-" + photoUrl);
    $("#show-photo a").attr("href", "sites/funk/files/" + photoUrl);
  }
  $("#open-dialog").click(function() {
    $("#dialog-message").dialog("open");
    false;
  });
});
